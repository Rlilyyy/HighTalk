<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="css\Font-Awesome-3.2.1\css\font-awesome.min.css">
	<title>{{title}}</title>
	<style type="text/css">
		html {
			font-size: 62.5%;
			height: 100%;
		}
		body {
			height: 100%;
			font-size: 2rem;
			font-family: "Microsoft Yahei", "Helvetica Neue", Helvetica, Arial, sans-serif;
			margin: 0;
			background: url('images/login5.jpg') no-repeat center;
			background-size: 100% 100%;
			overflow-x: hidden;
		}
		body .hide {
			opacity: 0;
			left: 3000px;
			-webkit-font-smoothing: antialiased;
		}
		.default {
			background-color: rgba(217,217,217,0.8);
			position: absolute;
			left: 50%;
			top: 50%;
			transition: 0.5s ease all;
			-webkit-transition: 0.5s ease all;
			-moz-transition: 0.5s ease all;
		}
		.login {
			width: 400px;
			height: 330px;
			margin-left: -200px;
			margin-top: -150px;
			border-radius: 5px;
		}
		.register {
			width: 400px;
			height: 450px;
			margin-left: -200px;
			margin-top: -210px;
			border-radius: 5px;
		}
		.login input,.register input[type="text"],.register input[type="password"],.register input[type="submit"] {
			width: 370px;
			height: 50px;
			border-radius: 3.5px;
			border: 1px solid rgb(193,205,205);
			display: block;
			margin: 15px auto;
			padding: 5px 15px;
			outline: none;
			font-size: 1.6rem;
			box-sizing: border-box;
			-moz-box-sizing: border-box;
			transition: 0.5s ease border;
			-webkit-transition: 0.5s ease border;
			-moz-transition: 0.5s ease border;
		}
		input[type="text"]:hover,input[type="password"]:hover {
			border-color: rgb(150,150,150);
		}
		.login #username {
			margin-top: 80px;
		}
		.login #submit {
			font-size: 1.7rem;
			font-family: "Microsoft Yahei", "Helvetica Neue", Helvetica, Arial, sans-serif;
			color: white;
			background-color: rgb(0,167,157);
			margin-bottom: 10px;
		}
		.register input[type="submit"] {
			font-size: 1.7rem;
			font-family: "Microsoft Yahei", "Helvetica Neue", Helvetica, Arial, sans-serif;
			color: white;
			background-color: rgb(0,167,157);
		}

		#username:focus,#password:focus,.register input[type="text"]:focus,.register input[type="password"]:focus {
			border-color: rgb(0,167,157);
		}
		.register input[type="radio"] {
			margin-left: 15px;
		}
		.register label {
			font-size: 1.7rem;
		}
		.img-user {
			position: absolute;
			width: 100px;
			height: 100px;
			border-radius: 50%;
			border: 5px solid rgb(0,167,157);
			box-sizing: border-box;
			-moz-box-sizing: border-box;
			left: 50%;
			top: -50px;
			margin-left: -50px;
			overflow: hidden;
			/*background: url('user.jpg') no-repeat center;*/
		}
		input[type="submit"]:active,#submit:active {
			background-color: rgb(0,167,137);
		}

		input {
			font-family: "Microsoft Yahei", "Helvetica Neue", Helvetica, Arial, sans-serif;
		}
		#goRegister,#goLogin {
			font-size: 1.4rem;
			float: right;
			padding-right: 15px;
			color: black;
		}

		#uname {
			width: 330px;
			margin: 15px 5px 15px 15px;
			display: inline-block;
		}
		#check {
			background-color: rgb(0,167,157);
			padding: 5px 15px;
			font-size: 1.4rem;
			color: white;
			cursor: pointer;
		}
		#check:active {
			background-color: rgb(0,147,157);
		}
		#confirm-status {
			height: 24px;
			font-size: 1.4rem;
			display: block;
			text-align: right;
			padding-top: 5px;
			padding-right: 20px;
		}
		#confirm-psw {
			margin-bottom: 0;
		}
		.confirm-true {
			color: green !important;
		}
		.confirm-false {
			color: red !important;
		}
		.icon-ok {
			display: inline-block;
			width: 20px;
			height: 20px;
			color: green;
		}
		.icon-remove {
			display: inline-block;
			width: 20px;
			height: 20px;
			color: red;
		}
		.icon-refresh {
			display: inline-block;
			width: 20px;
			height: 20px;
			color: rgb(0,167,157);
		}

		#login-check {
			height: 24px;
			font-size: 1.4rem;
			display: block;
			text-align: right;
			padding-top: 5px;
			padding-right: 20px;
			color: red;
		}
		#password {
			margin-bottom: 0;
		}
	</style>
</head>
<body>
	<div class="login default" id="login">
		<div class="img-user">
			<img id="img-default" src="images/user.jpeg" width="90px" height="90px">
		</div>
		<form action="/login" autocomplete="off" method="post">
			<input type="text" placeholder="请输入你的账号或邮箱" id="username" name="username" autofocus="autofocus" pattern="[a-z0-9]{6,16}" title="账号只能由6-16位的小写字母和数字组成" min="6" max="16" required="required">
			<input type="password" placeholder="请输入你的密码" id="password" name="password" pattern="[A-Za-z0-9]{6,22}" title="密码至少6位且密码不能有特殊字符(#、$、%等)" min="6" max="22" required="required">
			<span id="login-check">{{check}}</span>
			<input type="submit" id="submit" value="登录">
			<a href="#" id="goRegister">没有账号？去注册！</a>
		</form>
	</div>
	<div class="register default hide" id="register">
		<form action="/login/doRegister" autocomplete="off" method="post" id="form-reg">
			<input type="text" name="nickname" placeholder="请输入你的昵称" min="1" max="6" required="required">
			<div>
				<input type="radio" name="sex" value="男" id="male"><label for="male" checked>男</label>
				<input type="radio" name="sex" value="女" id="female"><label for="female">女</label>
			</div>
			<input type="text" name="username" placeholder="请输入你的账号" id="uname" pattern="[a-z0-9]{6,16}" title="账号只能由6-16位的小写字母和数字组成" min="6" max="16" required="required">
			<i class="icon-refresh" id="check-status"></i>
			<!-- <span id="check">检测用户名</span> -->
			
			<input type="password" name="password" placeholder="请输入你的密码" pattern="[A-Za-z0-9]{6,22}" title="密码至少6位且密码不能有特殊字符(#、$、%等)" id="psw" min="6" max="22" required="required">
			<input type="password" name="cofirm" placeholder="请确认你的密码" id="confirm-psw" required="required">
			<span id="confirm-status" class="confirm-true"></span>
			<input type="submit" value="提交注册">
			<a href="#" id="goLogin">已有账号？去登录！</a>	
		</form>
	</div>
	<script src="/js/bjax.js"></script>
	<script type="text/javascript">
		(function() {
			var hideFlag = false;
			var loginDom = document.getElementById("login");
			var registerDom = document.getElementById("register");

			var loginDefaultClass = "login default";
			var regDefaultClass = "register default";
			var hideClassName = " hide";

			var goLogin = document.getElementById("goLogin");
			var goRegister = document.getElementById("goRegister");

			var goEvent = function() {
				hideFlag = !hideFlag;
				if(hideFlag) {
					registerDom.style.display = "block";
					loginDom.className += hideClassName;
					registerDom.className = regDefaultClass;
				}else {
					loginDom.style.display = "block";
					registerDom.className += hideClassName;
					loginDom.className = loginDefaultClass;
				}
			}

			goLogin.onclick = goEvent;
			goRegister.onclick = goEvent;
		})();

		(function() {
			var checkName = "";
			var checkFlag = false;
			var statusElem = document.getElementById("check-status");
			document.getElementById("male").click();

			document.getElementById("uname").oninput = function() {
				var lowerCase = this.value.toLowerCase();

				if(lowerCase != this.value || lowerCase.length < 6 || lowerCase.length > 16) {
					checkFlag = false;
				    statusElem.className = "icon-remove";
				}else {
					bjax.chain()
					    .setURL("login/doCheck?username="+this.value)
					    .setType("GET")
					    .setData("")
					    .setAsync(true)
					    .tab(console.log) // 这里将在控制台打印当前设置好的数据的object
					    .success(function(data) {
					    	if(data == "已存在") {
					    		checkFlag = false;
					    		statusElem.className = "icon-remove";
					    	}else if(data == "不存在") {
					    		checkFlag = true;
					    		statusElem.className = "icon-ok";
					    	}else {
					    		alert("网络异常")
					    	}
					    })
					    .start();
				}
			};

			document.getElementById("form-reg").onsubmit = function() {
				var username = document.getElementById("uname").value;
				var password = document.getElementById("psw").value;
				var confirm = document.getElementById("confirm-psw").value;
				var confirmElem = document.getElementById("confirm-status");
				if(!(password === confirm)) {
					confirmElem.className = "confirm-false";
					confirmElem.innerHTML = "请确认你的密码是否一致";
					return false;
				}else {
					confirmElem.className = "confirm-true";
					confirmElem.innerHTML = "密码验证通过";
				}

				if(!checkFlag)
					return false;
			};
		})();
	</script>
</body>
</html>